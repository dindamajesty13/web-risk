from lib.database import db_connect

def getVulnerability():
    conn = db_connect()
    with conn:
        cur = conn.cursor()
        cur.execute(f"SELECT * FROM public.vulnerability ORDER BY id_vulnerability ASC")
        data = cur.fetchall()
        return data

def getCountVulnerability():
    conn = db_connect()
    with conn:
        cur = conn.cursor()
        cur.execute(f"SELECT COUNT(id_vulnerability) FROM public.vulnerability")
        data = cur.fetchall()
        return data

def insertVulnerability(id_vulnerability, vulnerability_name, vulnerability_level):
    conn = db_connect()
    with conn:
        cur = conn.cursor()
        cur.execute(f"INSERT INTO public.vulnerability (id_vulnerability, vulnerability_name, vulnerability_level) VALUES ('{id_vulnerability}', '{vulnerability_name}', '{vulnerability_level}')")
    return True


def updateVulnerability(id_vulnerability, vulnerability_name, vulnerability_level):
    conn = db_connect()
    with conn:
        cur = conn.cursor()
        cur.execute(f"UPDATE public.vulnerability SET vulnerability_name='{vulnerability_name}', vulnerability_level='{vulnerability_level}' WHERE public.vulnerability.id_vulnerability='{id_vulnerability}'")
    return True


def deleteVulnerability(id_vulnerability):
    conn = db_connect()
    with conn:
        cur = conn.cursor()
        cur.execute(f"DELETE FROM public.vulnerability WHERE public.vulnerability.id_vulnerability='{id_vulnerability}'")
    return True
