from lib.database import db_connect


def getVulnerabilityAVG():
    conn = db_connect()
    with conn:
        cur = conn.cursor()
        cur.execute(f"SELECT * FROM public.threat_vulnerability JOIN public.vulnerability ON public.threat_vulnerability.id_vulnerabilities = public.vulnerability.id_vulnerability ORDER BY public.threat_vulnerability.id_threat ASC")
        data = cur.fetchall()
        return data

def getVulnerabilityAVGbyID():
    conn = db_connect()
    with conn:
        cur = conn.cursor()
        cur.execute(f"SELECT * FROM public.threat_vulnerability")
        data = cur.fetchall()
        return data

def insertVulnerabilityAVG(id_threat, id_vulnerabilities):
    conn = db_connect()
    with conn:
        cur = conn.cursor()
        cur.execute(f"INSERT INTO public.threat_vulnerability (id_threat, id_vulnerabilities) VALUES ('{id_threat}', '{id_vulnerabilities}')")
    return True

def deleteVulnerabilityAVG(id_threat):
    conn = db_connect()
    with conn:
        cur = conn.cursor()
        cur.execute(f"DELETE FROM public.threat_vulnerability WHERE public.threat_vulnerability.id_threat='{id_threat}'")
    return True
